+ ENGINE=vllm
+ export VLLM_ATTENTION_BACKEND=XFORMERS
+ VLLM_ATTENTION_BACKEND=XFORMERS
+ num_cpus_per_env_worker=0.1
+ train_data_size=16
+ val_data_size=128
+ group_size=8
+ python3 -m examples.data_preprocess.prepare --mode text --train_data_size 16 --val_data_size 128
processing data for mode: text
Creating parquet from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating parquet from Arrow format: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 71.84ba/s]
Creating parquet from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating parquet from Arrow format: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 1979.38ba/s]
Exception ignored in: <function ResourceTracker.__del__ at 0x7f07eceec900>
Traceback (most recent call last):
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 80, in __del__
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 89, in _stop
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 102, in _stop_locked
AttributeError: '_thread.RLock' object has no attribute '_recursion_count'
+ python3 -m verl.trainer.main_ppo algorithm.adv_estimator=grpo data.train_files=/users/3/peng0504/data/verl-agent/text/train.parquet data.val_files=/users/3/peng0504/data/verl-agent/text/test.parquet data.train_batch_size=16 data.val_batch_size=128 data.max_prompt_length=2048 data.max_response_length=512 data.filter_overlong_prompts=True data.truncation=error data.return_raw_chat=True actor_rollout_ref.model.path=Qwen/Qwen2.5-0.5B-Instruct actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=256 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=32 actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.01 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=32 actor_rollout_ref.rollout.tensor_model_parallel_size=2 actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.gpu_memory_utilization=0.6 actor_rollout_ref.rollout.enable_chunked_prefill=False actor_rollout_ref.rollout.enforce_eager=False actor_rollout_ref.rollout.free_cache_engine=False actor_rollout_ref.rollout.val_kwargs.temperature=0.4 actor_rollout_ref.rollout.val_kwargs.do_sample=True actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=32 actor_rollout_ref.ref.fsdp_config.param_offload=True actor_rollout_ref.actor.use_invalid_action_penalty=True actor_rollout_ref.actor.invalid_action_penalty_coef=0.1 algorithm.use_kl_in_reward=False env.env_name=alfworld/AlfredTWEnv env.seed=0 env.max_steps=50 env.rollout.n=8 env.resources_per_worker.num_cpus=0.1 trainer.critic_warmup=0 'trainer.logger=[console,wandb]' trainer.project_name=verl_agent_alfworld trainer.experiment_name=grpo_qwen2.5_0.5b trainer.n_gpus_per_node=4 trainer.nnodes=1 trainer.save_freq=-1 trainer.test_freq=5 trainer.total_epochs=150 trainer.val_before_train=True
2025-12-03 18:17:05,658	INFO worker.py:1942 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=432512)[0m   0%|          | 0/8810 [00:00<?, ?it/s]
[36m(TaskRunner pid=432512)[0m   0%|          | 33/8810 [00:00<00:26, 326.92it/s]
[36m(TaskRunner pid=432512)[0m   1%|          | 73/8810 [00:00<00:23, 367.67it/s]
[36m(TaskRunner pid=432512)[0m   1%|â–         | 111/8810 [00:00<00:23, 368.97it/s]
[36m(TaskRunner pid=432512)[0m   2%|â–         | 148/8810 [00:00<00:23, 363.85it/s]
[36m(TaskRunner pid=432512)[0m   2%|â–         | 187/8810 [00:00<00:23, 371.53it/s]
[36m(TaskRunner pid=432512)[0m   3%|â–Ž         | 229/8810 [00:00<00:22, 386.87it/s]
[36m(TaskRunner pid=432512)[0m   3%|â–Ž         | 269/8810 [00:00<00:22, 387.09it/s]
[36m(TaskRunner pid=432512)[0m   4%|â–Ž         | 317/8810 [00:00<00:20, 414.70it/s]
[36m(TaskRunner pid=432512)[0m   4%|â–         | 375/8810 [00:00<00:18, 465.31it/s]
[36m(TaskRunner pid=432512)[0m   5%|â–         | 433/8810 [00:01<00:16, 496.50it/s]
[36m(TaskRunner pid=432512)[0m   5%|â–Œ         | 483/8810 [00:01<00:17, 471.96it/s]
[36m(TaskRunner pid=432512)[0m   6%|â–Œ         | 531/8810 [00:01<00:18, 453.91it/s]
[36m(TaskRunner pid=432512)[0m   7%|â–‹         | 577/8810 [00:01<00:18, 448.43it/s]
[36m(TaskRunner pid=432512)[0m   7%|â–‹         | 623/8810 [00:01<00:19, 424.57it/s]
[36m(TaskRunner pid=432512)[0m   8%|â–Š         | 666/8810 [00:01<00:20, 387.98it/s]
[36m(TaskRunner pid=432512)[0m   8%|â–Š         | 706/8810 [00:01<00:23, 343.70it/s]
[36m(TaskRunner pid=432512)[0m   9%|â–Š         | 765/8810 [00:01<00:19, 402.46it/s]
[36m(TaskRunner pid=432512)[0m   9%|â–‰         | 808/8810 [00:01<00:20, 388.26it/s]
[36m(TaskRunner pid=432512)[0m  10%|â–‰         | 859/8810 [00:02<00:19, 416.41it/s]
[36m(TaskRunner pid=432512)[0m  10%|â–ˆ         | 902/8810 [00:02<00:19, 407.45it/s]
[36m(TaskRunner pid=432512)[0m  11%|â–ˆ         | 944/8810 [00:02<00:19, 402.56it/s]
[36m(TaskRunner pid=432512)[0m  11%|â–ˆ         | 985/8810 [00:02<00:31, 249.36it/s]
[36m(TaskRunner pid=432512)[0m  12%|â–ˆâ–        | 1036/8810 [00:02<00:26, 298.71it/s]
[36m(TaskRunner pid=432512)[0m  12%|â–ˆâ–        | 1074/8810 [00:02<00:25, 308.20it/s]
[36m(TaskRunner pid=432512)[0m  13%|â–ˆâ–Ž        | 1111/8810 [00:02<00:24, 313.45it/s]
[36m(TaskRunner pid=432512)[0m  13%|â–ˆâ–Ž        | 1148/8810 [00:03<00:23, 325.46it/s]
[36m(TaskRunner pid=432512)[0m  13%|â–ˆâ–Ž        | 1184/8810 [00:03<00:23, 325.34it/s]
[36m(TaskRunner pid=432512)[0m  14%|â–ˆâ–        | 1219/8810 [00:03<00:23, 328.09it/s]
[36m(TaskRunner pid=432512)[0m  14%|â–ˆâ–        | 1254/8810 [00:03<00:23, 328.04it/s]
[36m(TaskRunner pid=432512)[0m  15%|â–ˆâ–        | 1288/8810 [00:03<00:24, 304.28it/s]
[36m(TaskRunner pid=432512)[0m  15%|â–ˆâ–        | 1320/8810 [00:03<00:25, 293.10it/s]
[36m(TaskRunner pid=432512)[0m  15%|â–ˆâ–Œ        | 1360/8810 [00:03<00:23, 320.73it/s]
[36m(TaskRunner pid=432512)[0m  16%|â–ˆâ–Œ        | 1398/8810 [00:03<00:22, 336.58it/s]
[36m(TaskRunner pid=432512)[0m  16%|â–ˆâ–‹        | 1433/8810 [00:03<00:21, 338.93it/s]
[36m(TaskRunner pid=432512)[0m  17%|â–ˆâ–‹        | 1468/8810 [00:04<00:22, 333.07it/s]
[36m(TaskRunner pid=432512)[0m  17%|â–ˆâ–‹        | 1510/8810 [00:04<00:20, 352.26it/s]
[36m(TaskRunner pid=432512)[0m  18%|â–ˆâ–Š        | 1546/8810 [00:04<00:20, 347.34it/s]
[36m(TaskRunner pid=432512)[0m  18%|â–ˆâ–Š        | 1581/8810 [00:04<00:21, 343.48it/s]
[36m(TaskRunner pid=432512)[0m  18%|â–ˆâ–Š        | 1616/8810 [00:04<00:21, 335.92it/s]
[36m(TaskRunner pid=432512)[0m  19%|â–ˆâ–‰        | 1654/8810 [00:04<00:20, 346.44it/s]
[36m(TaskRunner pid=432512)[0m  19%|â–ˆâ–‰        | 1689/8810 [00:04<00:20, 344.51it/s]
[36m(TaskRunner pid=432512)[0m  20%|â–ˆâ–‰        | 1724/8810 [00:04<00:20, 341.94it/s]
[36m(TaskRunner pid=432512)[0m  20%|â–ˆâ–‰        | 1759/8810 [00:04<00:21, 332.94it/s]
[36m(TaskRunner pid=432512)[0m  20%|â–ˆâ–ˆ        | 1793/8810 [00:05<00:21, 322.97it/s]
[36m(TaskRunner pid=432512)[0m  21%|â–ˆâ–ˆ        | 1831/8810 [00:05<00:20, 337.82it/s]
[36m(TaskRunner pid=432512)[0m  21%|â–ˆâ–ˆâ–       | 1876/8810 [00:05<00:19, 363.62it/s]
[36m(TaskRunner pid=432512)[0m  22%|â–ˆâ–ˆâ–       | 1913/8810 [00:05<00:19, 350.81it/s]
[36m(TaskRunner pid=432512)[0m  22%|â–ˆâ–ˆâ–       | 1952/8810 [00:05<00:19, 359.69it/s]
[36m(TaskRunner pid=432512)[0m  23%|â–ˆâ–ˆâ–Ž       | 1989/8810 [00:05<00:19, 352.42it/s]
[36m(TaskRunner pid=432512)[0m  23%|â–ˆâ–ˆâ–Ž       | 2027/8810 [00:05<00:18, 357.25it/s]
[36m(TaskRunner pid=432512)[0m  23%|â–ˆâ–ˆâ–Ž       | 2063/8810 [00:05<00:19, 352.06it/s]
[36m(TaskRunner pid=432512)[0m  24%|â–ˆâ–ˆâ–       | 2099/8810 [00:05<00:19, 341.93it/s]
[36m(TaskRunner pid=432512)[0m  24%|â–ˆâ–ˆâ–       | 2140/8810 [00:05<00:18, 358.24it/s]
[36m(TaskRunner pid=432512)[0m  25%|â–ˆâ–ˆâ–       | 2176/8810 [00:06<00:18, 356.18it/s]
[36m(TaskRunner pid=432512)[0m  25%|â–ˆâ–ˆâ–Œ       | 2212/8810 [00:06<00:18, 354.25it/s]
[36m(TaskRunner pid=432512)[0m  26%|â–ˆâ–ˆâ–Œ       | 2248/8810 [00:06<00:18, 351.98it/s]
[36m(TaskRunner pid=432512)[0m  26%|â–ˆâ–ˆâ–Œ       | 2301/8810 [00:06<00:16, 401.80it/s]
[36m(TaskRunner pid=432512)[0m  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 3692/8810 [00:06<00:01, 4296.59it/s]
[36m(TaskRunner pid=432512)[0m  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 4120/8810 [00:07<00:05, 923.91it/s] 
[36m(TaskRunner pid=432512)[0m  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4429/8810 [00:09<00:08, 536.07it/s]
[36m(TaskRunner pid=432512)[0m  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 4652/8810 [00:09<00:08, 472.32it/s]
[36m(TaskRunner pid=432512)[0m  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 4818/8810 [00:10<00:10, 386.76it/s]
[36m(TaskRunner pid=432512)[0m  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 4940/8810 [00:11<00:10, 369.91it/s]
[36m(TaskRunner pid=432512)[0m  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 5035/8810 [00:11<00:09, 396.40it/s]
[36m(TaskRunner pid=432512)[0m  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 5122/8810 [00:11<00:10, 353.94it/s]
[36m(TaskRunner pid=432512)[0m  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 5222/8810 [00:11<00:08, 407.49it/s]
[36m(TaskRunner pid=432512)[0m  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 5299/8810 [00:12<00:09, 370.69it/s]
[36m(TaskRunner pid=432512)[0m  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 5361/8810 [00:12<00:10, 340.21it/s]
[36m(TaskRunner pid=432512)[0m  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 5412/8810 [00:12<00:10, 325.53it/s]
[36m(TaskRunner pid=432512)[0m  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5531/8810 [00:12<00:07, 441.74it/s]
[36m(TaskRunner pid=432512)[0m  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5597/8810 [00:12<00:08, 370.56it/s]
[36m(TaskRunner pid=432512)[0m  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 5651/8810 [00:13<00:09, 325.39it/s]
[36m(TaskRunner pid=432512)[0m  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 5695/8810 [00:13<00:09, 314.04it/s]
[36m(TaskRunner pid=432512)[0m  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 5734/8810 [00:13<00:13, 234.55it/s]
[36m(TaskRunner pid=432512)[0m  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 5765/8810 [00:13<00:13, 231.34it/s]
[36m(TaskRunner pid=432512)[0m  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 5794/8810 [00:13<00:13, 223.62it/s]
[36m(TaskRunner pid=432512)[0m  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 5820/8810 [00:14<00:13, 226.24it/s]
[36m(TaskRunner pid=432512)[0m  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 5845/8810 [00:14<00:12, 228.79it/s]
[36m(TaskRunner pid=432512)[0m  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 5870/8810 [00:14<00:12, 226.17it/s]
[36m(TaskRunner pid=432512)[0m  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 5896/8810 [00:14<00:12, 232.33it/s]
[36m(TaskRunner pid=432512)[0m  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 5980/8810 [00:14<00:07, 373.93it/s]
[36m(TaskRunner pid=432512)[0m  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 6020/8810 [00:14<00:08, 345.93it/s]
[36m(TaskRunner pid=432512)[0m  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6104/8810 [00:14<00:05, 467.91it/s]
[36m(TaskRunner pid=432512)[0m  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 6155/8810 [00:14<00:07, 354.40it/s]
[36m(TaskRunner pid=432512)[0m  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 6197/8810 [00:15<00:08, 314.69it/s]
[36m(TaskRunner pid=432512)[0m  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 6461/8810 [00:15<00:02, 797.01it/s]
[36m(TaskRunner pid=432512)[0m  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 6564/8810 [00:15<00:04, 477.74it/s]
[36m(TaskRunner pid=432512)[0m  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6643/8810 [00:16<00:05, 371.68it/s]
[36m(TaskRunner pid=432512)[0m  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6705/8810 [00:16<00:07, 280.43it/s]
[36m(TaskRunner pid=432512)[0m  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 6753/8810 [00:16<00:07, 261.80it/s]
[36m(TaskRunner pid=432512)[0m  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 6793/8810 [00:16<00:07, 256.03it/s]
[36m(TaskRunner pid=432512)[0m  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 6828/8810 [00:17<00:07, 254.31it/s]
[36m(TaskRunner pid=432512)[0m  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 6860/8810 [00:17<00:07, 248.64it/s]
[36m(TaskRunner pid=432512)[0m  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 6889/8810 [00:17<00:07, 245.24it/s]
[36m(TaskRunner pid=432512)[0m  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 6919/8810 [00:17<00:07, 253.45it/s]
[36m(TaskRunner pid=432512)[0m  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 6947/8810 [00:17<00:07, 252.53it/s]
[36m(TaskRunner pid=432512)[0m  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 6974/8810 [00:17<00:07, 246.80it/s]
[36m(TaskRunner pid=432512)[0m  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 7007/8810 [00:17<00:06, 265.90it/s]
[36m(TaskRunner pid=432512)[0m  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 7161/8810 [00:17<00:02, 585.22it/s]
[36m(TaskRunner pid=432512)[0m  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 7225/8810 [00:18<00:03, 409.65it/s]
[36m(TaskRunner pid=432512)[0m  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 7361/8810 [00:18<00:02, 601.39it/s]
[36m(TaskRunner pid=432512)[0m  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 7437/8810 [00:18<00:02, 463.66it/s]
[36m(TaskRunner pid=432512)[0m  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 7499/8810 [00:18<00:02, 437.83it/s]
[36m(TaskRunner pid=432512)[0m  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 7554/8810 [00:18<00:03, 404.64it/s]
[36m(TaskRunner pid=432512)[0m  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 7602/8810 [00:18<00:03, 361.67it/s]
[36m(TaskRunner pid=432512)[0m  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 7644/8810 [00:19<00:03, 346.03it/s]
[36m(TaskRunner pid=432512)[0m  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 7689/8810 [00:19<00:03, 366.34it/s]
[36m(TaskRunner pid=432512)[0m  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7729/8810 [00:19<00:03, 359.18it/s]
[36m(TaskRunner pid=432512)[0m  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7768/8810 [00:19<00:03, 342.72it/s]
[36m(TaskRunner pid=432512)[0m  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7804/8810 [00:19<00:03, 334.68it/s]
[36m(TaskRunner pid=432512)[0m  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 7839/8810 [00:19<00:03, 244.37it/s]
[36m(TaskRunner pid=432512)[0m  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 7876/8810 [00:19<00:03, 268.89it/s]
[36m(TaskRunner pid=432512)[0m  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 7908/8810 [00:20<00:03, 278.55it/s]
[36m(TaskRunner pid=432512)[0m  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 7939/8810 [00:20<00:03, 282.90it/s]
[36m(TaskRunner pid=432512)[0m  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 7970/8810 [00:20<00:02, 285.60it/s]
[36m(TaskRunner pid=432512)[0m  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 8001/8810 [00:20<00:02, 276.50it/s]
[36m(TaskRunner pid=432512)[0m  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 8030/8810 [00:20<00:02, 264.49it/s]
[36m(TaskRunner pid=432512)[0m  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8058/8810 [00:20<00:03, 248.12it/s]
[36m(TaskRunner pid=432512)[0m  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8088/8810 [00:20<00:02, 259.38it/s]
[36m(TaskRunner pid=432512)[0m  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8115/8810 [00:20<00:02, 261.17it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8143/8810 [00:20<00:02, 265.21it/s]
[36m(TaskRunner pid=432512)[0m  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 8172/8810 [00:21<00:02, 271.05it/s]
[36m(TaskRunner pid=432512)[0m  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 8200/8810 [00:21<00:02, 266.52it/s]
[36m(TaskRunner pid=432512)[0m  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 8228/8810 [00:21<00:02, 266.06it/s]
[36m(TaskRunner pid=432512)[0m  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8273/8810 [00:21<00:01, 317.70it/s]
[36m(TaskRunner pid=432512)[0m  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8306/8810 [00:21<00:01, 315.25it/s]
[36m(TaskRunner pid=432512)[0m  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 8338/8810 [00:21<00:01, 294.30it/s]
[36m(TaskRunner pid=432512)[0m  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 8373/8810 [00:21<00:01, 308.85it/s]
[36m(TaskRunner pid=432512)[0m  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 8411/8810 [00:21<00:01, 327.27it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 8445/8810 [00:21<00:01, 329.20it/s]
[36m(TaskRunner pid=432512)[0m  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 8479/8810 [00:21<00:01, 324.60it/s]
[36m(TaskRunner pid=432512)[0m  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 8512/8810 [00:22<00:00, 318.62it/s]
[36m(TaskRunner pid=432512)[0m  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 8545/8810 [00:22<00:00, 315.38it/s]
[36m(TaskRunner pid=432512)[0m  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 8577/8810 [00:22<00:00, 311.42it/s]
[36m(TaskRunner pid=432512)[0m  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 8609/8810 [00:22<00:00, 307.30it/s]
[36m(TaskRunner pid=432512)[0m  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 8640/8810 [00:22<00:00, 300.08it/s]
[36m(TaskRunner pid=432512)[0m  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 8672/8810 [00:22<00:00, 303.05it/s]
[36m(TaskRunner pid=432512)[0m  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 8709/8810 [00:22<00:00, 309.34it/s]
[36m(TaskRunner pid=432512)[0m  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 8741/8810 [00:22<00:00, 311.78it/s]
[36m(TaskRunner pid=432512)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 8774/8810 [00:22<00:00, 314.64it/s]
[36m(TaskRunner pid=432512)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 8806/8810 [00:23<00:00, 315.07it/s]
[36m(TaskRunner pid=432512)[0m 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8810/8810 [00:23<00:00, 382.08it/s]
[36m(TaskRunner pid=432512)[0m   0%|          | 0/494 [00:00<?, ?it/s]
[36m(TaskRunner pid=432512)[0m   5%|â–         | 24/494 [00:00<00:02, 230.56it/s]
[36m(TaskRunner pid=432512)[0m  11%|â–ˆ         | 52/494 [00:00<00:01, 248.21it/s]
[36m(TaskRunner pid=432512)[0m  16%|â–ˆâ–Œ        | 77/494 [00:00<00:02, 196.32it/s]
[36m(TaskRunner pid=432512)[0m  20%|â–ˆâ–‰        | 98/494 [00:00<00:02, 166.52it/s]
[36m(TaskRunner pid=432512)[0m  24%|â–ˆâ–ˆâ–Ž       | 117/494 [00:00<00:02, 172.75it/s]
[36m(TaskRunner pid=432512)[0m  28%|â–ˆâ–ˆâ–Š       | 140/494 [00:00<00:01, 182.50it/s]
[36m(TaskRunner pid=432512)[0m  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 222/494 [00:00<00:00, 355.69it/s]
[36m(TaskRunner pid=432512)[0m  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 260/494 [00:01<00:00, 297.90it/s]
[36m(TaskRunner pid=432512)[0m  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 293/494 [00:01<00:00, 262.37it/s]
[36m(TaskRunner pid=432512)[0m  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 322/494 [00:01<00:00, 238.38it/s]
[36m(TaskRunner pid=432512)[0m  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 348/494 [00:01<00:00, 230.80it/s]
[36m(TaskRunner pid=432512)[0m  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 373/494 [00:01<00:00, 225.77it/s]
[36m(TaskRunner pid=432512)[0m  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 397/494 [00:01<00:00, 206.10it/s]
[36m(TaskRunner pid=432512)[0m  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 435/494 [00:01<00:00, 240.63it/s]
[36m(TaskRunner pid=432512)[0m  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 461/494 [00:01<00:00, 220.24it/s]
[36m(TaskRunner pid=432512)[0m  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 484/494 [00:02<00:00, 219.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 494/494 [00:02<00:00, 227.82it/s]
[36m(TaskRunner pid=432512)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=432512)[0m                                                              'optimizer',
[36m(TaskRunner pid=432512)[0m                                                              'extra']},
[36m(TaskRunner pid=432512)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=432512)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=432512)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=432512)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=432512)[0m                                  'entropy_coeff': 0.001,
[36m(TaskRunner pid=432512)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=432512)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=432512)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=432512)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=432512)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=432512)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=432512)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=432512)[0m                                  'invalid_action_penalty_coef': 0.1,
[36m(TaskRunner pid=432512)[0m                                  'kl_loss_coef': 0.01,
[36m(TaskRunner pid=432512)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=432512)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=432512)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=432512)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=432512)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=432512)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=432512)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=432512)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=432512)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=432512)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=432512)[0m                                  'policy_loss': {'loss_mode': 'vanilla'},
[36m(TaskRunner pid=432512)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=432512)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=432512)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m                                  'ppo_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=432512)[0m                                  'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=432512)[0m                                  'shuffle': False,
[36m(TaskRunner pid=432512)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=432512)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=432512)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=432512)[0m                                  'use_invalid_action_penalty': True,
[36m(TaskRunner pid=432512)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=432512)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=432512)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=432512)[0m                        'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=432512)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=432512)[0m                                  'external_lib': None,
[36m(TaskRunner pid=432512)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=432512)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=432512)[0m                                  'override_config': {},
[36m(TaskRunner pid=432512)[0m                                  'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=432512)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=432512)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=432512)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=432512)[0m                                  'use_liger': False,
[36m(TaskRunner pid=432512)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=432512)[0m                                  'use_shm': False},
[36m(TaskRunner pid=432512)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=432512)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=432512)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=432512)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=432512)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=432512)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=432512)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=432512)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=432512)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=432512)[0m                        'rollout': {'chat_scheduler': None,
[36m(TaskRunner pid=432512)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=432512)[0m                                    'do_sample': True,
[36m(TaskRunner pid=432512)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=432512)[0m                                    'enable_chunked_prefill': False,
[36m(TaskRunner pid=432512)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=432512)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=432512)[0m                                                      'vllm': {'swap_space': None}},
[36m(TaskRunner pid=432512)[0m                                    'free_cache_engine': False,
[36m(TaskRunner pid=432512)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=432512)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=432512)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=432512)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=432512)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=432512)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=432512)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=432512)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=432512)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=432512)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=432512)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=432512)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=432512)[0m                                                   'format': 'chatml',
[36m(TaskRunner pid=432512)[0m                                                   'max_turns': None,
[36m(TaskRunner pid=432512)[0m                                                   'tool_config_path': None},
[36m(TaskRunner pid=432512)[0m                                    'n': 1,
[36m(TaskRunner pid=432512)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=432512)[0m                                    'prompt_length': 2048,
[36m(TaskRunner pid=432512)[0m                                    'response_length': 512,
[36m(TaskRunner pid=432512)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=432512)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=432512)[0m                                    'top_k': -1,
[36m(TaskRunner pid=432512)[0m                                    'top_p': 1,
[36m(TaskRunner pid=432512)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=432512)[0m                                    'val_kwargs': {'do_sample': True,
[36m(TaskRunner pid=432512)[0m                                                   'n': 1,
[36m(TaskRunner pid=432512)[0m                                                   'temperature': 0.4,
[36m(TaskRunner pid=432512)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=432512)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=432512)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=432512)[0m                'filter_groups': {'enable': False, 'max_num_gen_batches': 10},
[36m(TaskRunner pid=432512)[0m                'gamma': 1.0,
[36m(TaskRunner pid=432512)[0m                'gigpo': {'enable_similarity': False,
[36m(TaskRunner pid=432512)[0m                          'mode': 'mean_norm',
[36m(TaskRunner pid=432512)[0m                          'similarity_thresh': 0.95,
[36m(TaskRunner pid=432512)[0m                          'step_advantage_w': 1.0},
[36m(TaskRunner pid=432512)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=432512)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=432512)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=432512)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=432512)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=432512)[0m                'lam': 1.0,
[36m(TaskRunner pid=432512)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=432512)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=432512)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=432512)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=432512)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=432512)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=432512)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=432512)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=432512)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=432512)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=432512)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=432512)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=432512)[0m                       'external_lib': None,
[36m(TaskRunner pid=432512)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=432512)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=432512)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=432512)[0m                                       'param_offload': False,
[36m(TaskRunner pid=432512)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=432512)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=432512)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=432512)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=432512)[0m                       'override_config': {},
[36m(TaskRunner pid=432512)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=432512)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=432512)[0m                       'tokenizer_path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=432512)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=432512)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=432512)[0m                       'use_shm': False},
[36m(TaskRunner pid=432512)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=432512)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=432512)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=432512)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=432512)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=432512)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=432512)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=432512)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=432512)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=432512)[0m             'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=432512)[0m             'rollout_n': 1,
[36m(TaskRunner pid=432512)[0m             'shuffle': False,
[36m(TaskRunner pid=432512)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=432512)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=432512)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=432512)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=432512)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=432512)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=432512)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=432512)[0m           'image_key': 'images',
[36m(TaskRunner pid=432512)[0m           'max_prompt_length': 2048,
[36m(TaskRunner pid=432512)[0m           'max_response_length': 512,
[36m(TaskRunner pid=432512)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=432512)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=432512)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=432512)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=432512)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=432512)[0m           'shuffle': True,
[36m(TaskRunner pid=432512)[0m           'tokenizer': None,
[36m(TaskRunner pid=432512)[0m           'train_batch_size': 16,
[36m(TaskRunner pid=432512)[0m           'train_files': '/users/3/peng0504/data/verl-agent/text/train.parquet',
[36m(TaskRunner pid=432512)[0m           'truncation': 'error',
[36m(TaskRunner pid=432512)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=432512)[0m           'use_shm': False,
[36m(TaskRunner pid=432512)[0m           'val_batch_size': 128,
[36m(TaskRunner pid=432512)[0m           'val_files': '/users/3/peng0504/data/verl-agent/text/test.parquet',
[36m(TaskRunner pid=432512)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=432512)[0m  'env': {'alfworld': {'eval_dataset': 'eval_in_distribution'},
[36m(TaskRunner pid=432512)[0m          'env_name': 'alfworld/AlfredTWEnv',
[36m(TaskRunner pid=432512)[0m          'history_length': 2,
[36m(TaskRunner pid=432512)[0m          'max_steps': 50,
[36m(TaskRunner pid=432512)[0m          'resources_per_worker': {'num_cpus': 0.1, 'num_gpus': 0},
[36m(TaskRunner pid=432512)[0m          'rollout': {'n': 8},
[36m(TaskRunner pid=432512)[0m          'search': {'log_requests': False,
[36m(TaskRunner pid=432512)[0m                     'search_url': 'http://127.0.0.1:8000/retrieve',
[36m(TaskRunner pid=432512)[0m                     'timeout': 60,
[36m(TaskRunner pid=432512)[0m                     'topk': 3},
[36m(TaskRunner pid=432512)[0m          'seed': 0,
[36m(TaskRunner pid=432512)[0m          'sokoban': {'dim_room': [6, 6],
[36m(TaskRunner pid=432512)[0m                      'mode': 'tiny_rgb_array',
[36m(TaskRunner pid=432512)[0m                      'num_boxes': 1,
[36m(TaskRunner pid=432512)[0m                      'search_depth': 30},
[36m(TaskRunner pid=432512)[0m          'webshop': {'human_goals': False, 'use_small': True}},
[36m(TaskRunner pid=432512)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=432512)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=432512)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=432512)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=432512)[0m                   'max_length': None,
[36m(TaskRunner pid=432512)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=432512)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=432512)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=432512)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=432512)[0m                                             'param_offload': False,
[36m(TaskRunner pid=432512)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=432512)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=432512)[0m                             'input_tokenizer': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=432512)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=432512)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=432512)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=432512)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=432512)[0m                             'use_shm': False},
[36m(TaskRunner pid=432512)[0m                   'reward_manager': 'episode',
[36m(TaskRunner pid=432512)[0m                   'sandbox_fusion': {'max_concurrent': 64, 'url': None},
[36m(TaskRunner pid=432512)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=432512)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=432512)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=432512)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=432512)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=432512)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=432512)[0m              'default_local_dir': 'checkpoints/verl_agent_alfworld/grpo_qwen2.5_0.5b',
[36m(TaskRunner pid=432512)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=432512)[0m              'device': 'cuda',
[36m(TaskRunner pid=432512)[0m              'experiment_name': 'grpo_qwen2.5_0.5b',
[36m(TaskRunner pid=432512)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=432512)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=432512)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=432512)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=432512)[0m              'n_gpus_per_node': 4,
[36m(TaskRunner pid=432512)[0m              'nnodes': 1,
[36m(TaskRunner pid=432512)[0m              'project_name': 'verl_agent_alfworld',
[36m(TaskRunner pid=432512)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=432512)[0m              'resume_from_path': None,
[36m(TaskRunner pid=432512)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=432512)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=432512)[0m              'save_freq': -1,
[36m(TaskRunner pid=432512)[0m              'test_freq': 5,
[36m(TaskRunner pid=432512)[0m              'total_epochs': 150,
[36m(TaskRunner pid=432512)[0m              'total_training_steps': None,
[36m(TaskRunner pid=432512)[0m              'val_before_train': True,
[36m(TaskRunner pid=432512)[0m              'val_only': False,
[36m(TaskRunner pid=432512)[0m              'validation_data_dir': None}}
[36m(TaskRunner pid=432512)[0m Initializing AlfredTWEnv...
[36m(TaskRunner pid=432512)[0m Overall we have 3553 games in split=train
[36m(TaskRunner pid=432512)[0m Training with 3553 games
[36m(TaskRunner pid=432512)[0m use_expert = False
[36m(TaskRunner pid=432512)[0m Initializing AlfredTWEnv...
[36m(TaskRunner pid=432512)[0m Overall we have 140 games in split=eval_in_distribution
[36m(TaskRunner pid=432512)[0m Evaluating with 140 games
[36m(TaskRunner pid=432512)[0m use_expert = False
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffff56fe1849d503ae6400bc4b6c01000000 Worker ID: 9ba4b91d548213e69c8b55e42b15a8d6df67c2808efdc46724d7665f Node ID: 172d4ddccdb44df4d770bc90de0264d0324b3bb3f5bf23d0f0a90917 Worker IP address: 10.31.104.74 Worker port: 33085 Worker PID: 432512 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 2. End of file. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'data.train_files=/users/3/peng0504/data/verl-agent/text/train.parquet', 'data.val_files=/users/3/peng0504/data/verl-agent/text/test.parquet', 'data.train_batch_size=16', 'data.val_batch_size=128', 'data.max_prompt_length=2048', 'data.max_response_length=512', 'data.filter_overlong_prompts=True', 'data.truncation=error', 'data.return_raw_chat=True', 'actor_rollout_ref.model.path=Qwen/Qwen2.5-0.5B-Instruct', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=256', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=32', 'actor_rollout_ref.actor.use_kl_loss=True', 'actor_rollout_ref.actor.kl_loss_coef=0.01', 'actor_rollout_ref.actor.kl_loss_type=low_var_kl', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.fsdp_config.param_offload=False', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=False', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=32', 'actor_rollout_ref.rollout.tensor_model_parallel_size=2', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.6', 'actor_rollout_ref.rollout.enable_chunked_prefill=False', 'actor_rollout_ref.rollout.enforce_eager=False', 'actor_rollout_ref.rollout.free_cache_engine=False', 'actor_rollout_ref.rollout.val_kwargs.temperature=0.4', 'actor_rollout_ref.rollout.val_kwargs.do_sample=True', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=32', 'actor_rollout_ref.ref.fsdp_config.param_offload=True', 'actor_rollout_ref.actor.use_invalid_action_penalty=True', 'actor_rollout_ref.actor.invalid_action_penalty_coef=0.1', 'algorithm.use_kl_in_reward=False', 'env.env_name=alfworld/AlfredTWEnv', 'env.seed=0', 'env.max_steps=50', 'env.rollout.n=8', 'env.resources_per_worker.num_cpus=0.1', 'trainer.critic_warmup=0', 'trainer.logger=[console,wandb]', 'trainer.project_name=verl_agent_alfworld', 'trainer.experiment_name=grpo_qwen2.5_0.5b', 'trainer.n_gpus_per_node=4', 'trainer.nnodes=1', 'trainer.save_freq=-1', 'trainer.test_freq=5', 'trainer.total_epochs=150', 'trainer.val_before_train=True']
Traceback (most recent call last):
  File "/projects/standard/mhong/peng0504/options_agent/verl-agent/verl/trainer/main_ppo.py", line 29, in main
    run_ppo(config)
  File "/projects/standard/mhong/peng0504/options_agent/verl-agent/verl/trainer/main_ppo.py", line 41, in run_ppo
    ray.get(runner.run.remote(config))
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/ray/_private/worker.py", line 2882, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/ray/_private/worker.py", line 970, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: TaskRunner
	actor_id: 56fe1849d503ae6400bc4b6c01000000
	pid: 432512
	namespace: 3ff2e343-163c-4d5c-9ade-8c8850b9f7b6
	ip: 10.31.104.74
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 2. End of file. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Exception ignored in: <function ResourceTracker.__del__ at 0x7fd3f91caf20>
Traceback (most recent call last):
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 80, in __del__
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 89, in _stop
  File "/users/3/peng0504/.conda/envs/verl-agent/lib/python3.12/site-packages/multiprocess/resource_tracker.py", line 102, in _stop_locked
AttributeError: '_thread.RLock' object has no attribute '_recursion_count'
